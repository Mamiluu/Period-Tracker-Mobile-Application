"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.firestore=exports.auth=exports.resendVerificationEmail=exports.logoutUser=exports.getCurrentUser=exports.loginUser=exports.registerUser=void 0;var _app=_interopRequireDefault(require("firebase/compat/app"));require("firebase/compat/auth"),require("firebase/compat/firestore"),require("firebase/compat/storage");var _asyncStorage=_interopRequireDefault(require("@react-native-async-storage/async-storage")),_auth2=require("firebase/auth"),_firestore2=require("firebase/firestore");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function ownKeys(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(r);e&&(s=s.filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})),t.push.apply(t,s)}return t}function _objectSpread(r){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(t,!0).forEach(function(e){_defineProperty(r,e,t[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):ownKeys(t).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(t,e))})}return r}function _defineProperty(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function _objectWithoutProperties(e,r){if(null==e)return{};var t,s,a=_objectWithoutPropertiesLoose(e,r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(s=0;s<n.length;s++)t=n[s],0<=r.indexOf(t)||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}function _objectWithoutPropertiesLoose(e,r){if(null==e)return{};var t,s,a={},n=Object.keys(e);for(s=0;s<n.length;s++)t=n[s],0<=r.indexOf(t)||(a[t]=e[t]);return a}var firebaseConfig={apiKey:"AIzaSyDCyXIxCTVUg47CnbH-L7sceZ9lPG8oKVA",authDomain:"tracker-eed94.firebaseapp.com",projectId:"tracker-eed94",storageBucket:"tracker-eed94.appspot.com",messagingSenderId:"1082875479231",appId:"1:1082875479231:web:e8f72d1a300bd925e5f20a",measurementId:"G-JTTCJGC69C"};_app.default.apps.length||_app.default.initializeApp(firebaseConfig);var firestore=(0,_firestore2.getFirestore)();exports.firestore=firestore;var auth=(0,_auth2.initializeAuth)(_app.default.app(),{persistence:(0,_auth2.getReactNativePersistence)(_asyncStorage.default)});exports.auth=auth;var registerUser=function(r){var t,s,a,n,o,i,u;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.name,s=r.email,a=r.password,n=r.type,o=_objectWithoutProperties(r,["name","email","password","type"]),e.prev=1,e.next=4,regeneratorRuntime.awrap((0,_auth2.createUserWithEmailAndPassword)(auth,s,a));case 4:return i=e.sent,u=i.user,e.next=8,regeneratorRuntime.awrap((0,_firestore2.setDoc)((0,_firestore2.doc)(firestore,"users",u.uid),_objectSpread({name:t,email:s,type:n},o,{createdAt:(0,_firestore2.serverTimestamp)()})));case 8:return e.next=10,regeneratorRuntime.awrap((0,_auth2.sendEmailVerification)(u));case 10:return e.abrupt("return",{success:!0,user:u});case 13:return e.prev=13,e.t0=e.catch(1),console.error("Error registering user:",e.t0.message),e.abrupt("return",{success:!1,message:e.t0.message});case 17:case"end":return e.stop()}},null,null,[[1,13]])};exports.registerUser=registerUser;var loginUser=function(r,t){var s,a;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,regeneratorRuntime.awrap((0,_auth2.signInWithEmailAndPassword)(auth,r,t));case 3:if(s=e.sent,(a=s.user).emailVerified){e.next=7;break}throw new Error("Email not verified. Please check your email to verify your account.");case 7:return e.abrupt("return",{success:!0,user:a});case 10:return e.prev=10,e.t0=e.catch(0),console.error("Error logging in user:",e.t0.message),e.abrupt("return",{success:!1,message:e.t0.message});case 14:case"end":return e.stop()}},null,null,[[0,10]])};exports.loginUser=loginUser;var getCurrentUser=function(){return auth.currentUser};exports.getCurrentUser=getCurrentUser;var logoutUser=function(){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,regeneratorRuntime.awrap(auth.signOut());case 3:return e.abrupt("return",{success:!0});case 6:return e.prev=6,e.t0=e.catch(0),console.error("Error logging out:",e.t0.message),e.abrupt("return",{success:!1,message:e.t0.message});case 10:case"end":return e.stop()}},null,null,[[0,6]])};exports.logoutUser=logoutUser;var resendVerificationEmail=function(){var r;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:if((r=auth.currentUser)&&!r.emailVerified)return e.prev=2,e.next=5,regeneratorRuntime.awrap((0,_auth2.sendEmailVerification)(r));e.next=14;break;case 5:return e.abrupt("return",{success:!0,message:"Verification email resent. Please check your inbox."});case 8:return e.prev=8,e.t0=e.catch(2),console.error("Error resending verification email:",e.t0.message),e.abrupt("return",{success:!1,message:e.t0.message});case 12:e.next=15;break;case 14:return e.abrupt("return",{success:!1,message:"User is either not logged in or already verified."});case 15:case"end":return e.stop()}},null,null,[[2,8]])};exports.resendVerificationEmail=resendVerificationEmail;
//# sourceMappingURL=index.min.js.map
